import*as B from"https://unpkg.com/three/build/three.module.js";import{OrbitControls as vt}from"https://unpkg.com/three/examples/jsm/controls/OrbitControls.js";import{GLTFLoader as bt}from"https://unpkg.com/three/examples/jsm/loaders/GLTFLoader.js";import{RoomEnvironment as wt}from"https://unpkg.com/three/examples/jsm/environments/RoomEnvironment.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))i(r);new MutationObserver(r=>{for(const d of r)if(d.type==="childList")for(const y of d.addedNodes)y.tagName==="LINK"&&y.rel==="modulepreload"&&i(y)}).observe(document,{childList:!0,subtree:!0});function a(r){const d={};return r.integrity&&(d.integrity=r.integrity),r.referrerPolicy&&(d.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?d.credentials="include":r.crossOrigin==="anonymous"?d.credentials="omit":d.credentials="same-origin",d}function i(r){if(r.ep)return;r.ep=!0;const d=a(r);fetch(r.href,d)}})();/*!
 * Copyright (c) 2021 Momo Bassit.
 * Licensed under the MIT License (MIT)
 * https://github.com/mdbassit/Coloris
 */(function(n,t,a){var i,r,d,y,g,L,v,E,x,S,Me,W,q,D,se,G,ue=t.createElement("canvas").getContext("2d"),z={r:0,g:0,b:0,h:0,s:0,v:0,a:1},l={el:"[data-coloris]",parent:"body",theme:"default",themeMode:"light",rtl:!1,wrap:!0,margin:2,format:"hex",formatToggle:!1,swatches:[],swatchesOnly:!1,alpha:!0,forceAlpha:!1,focusInput:!0,selectInput:!1,inline:!1,defaultColor:"#000000",clearButton:!1,clearLabel:"Clear",closeButton:!1,closeLabel:"Close",onChange:function(){},a11y:{open:"Open color picker",close:"Close color picker",clear:"Clear the selected color",marker:"Saturation: {s}. Brightness: {v}.",hueSlider:"Hue slider",alphaSlider:"Opacity slider",input:"Color value field",format:"Color format",swatch:"Color swatch",instruction:"Saturation and brightness selector. Use up, down, left and right arrow keys to select."}},X={},Be="",V={},J=!1;function de(e){if(typeof e=="object")for(var o in e)switch(o){case"el":De(e.el),e.wrap!==!1&&pe(e.el);break;case"parent":(i=t.querySelector(e.parent))&&(i.appendChild(r),l.parent=e.parent,i===t.body&&(i=null));break;case"themeMode":l.themeMode=e.themeMode,e.themeMode==="auto"&&n.matchMedia&&n.matchMedia("(prefers-color-scheme: dark)").matches&&(l.themeMode="dark");case"theme":e.theme&&(l.theme=e.theme),r.className="clr-picker clr-"+l.theme+" clr-"+l.themeMode,l.inline&&fe();break;case"rtl":l.rtl=!!e.rtl,t.querySelectorAll(".clr-field").forEach(function(h){return h.classList.toggle("clr-rtl",l.rtl)});break;case"margin":e.margin*=1,l.margin=(isNaN(e.margin)?l:e).margin;break;case"wrap":e.el&&e.wrap&&pe(e.el);break;case"formatToggle":l.formatToggle=!!e.formatToggle,A("clr-format").style.display=l.formatToggle?"block":"none",l.formatToggle&&(l.format="auto");break;case"swatches":Array.isArray(e.swatches)&&function(){var h=[];e.swatches.forEach(function(p,w){h.push('<button type="button" id="clr-swatch-'+w+'" aria-labelledby="clr-swatch-label clr-swatch-'+w+'" style="color: '+p+';">'+p+"</button>")}),A("clr-swatches").innerHTML=h.length?"<div>"+h.join("")+"</div>":"",l.swatches=e.swatches.slice()}();break;case"swatchesOnly":l.swatchesOnly=!!e.swatchesOnly,r.setAttribute("data-minimal",l.swatchesOnly);break;case"alpha":l.alpha=!!e.alpha,r.setAttribute("data-alpha",l.alpha);break;case"inline":l.inline=!!e.inline,r.setAttribute("data-inline",l.inline),l.inline&&(s=e.defaultColor||l.defaultColor,se=_e(s),fe(),me(s));break;case"clearButton":typeof e.clearButton=="object"&&(e.clearButton.label&&(l.clearLabel=e.clearButton.label,E.innerHTML=l.clearLabel),e.clearButton=e.clearButton.show),l.clearButton=!!e.clearButton,E.style.display=l.clearButton?"block":"none";break;case"clearLabel":l.clearLabel=e.clearLabel,E.innerHTML=l.clearLabel;break;case"closeButton":l.closeButton=!!e.closeButton,l.closeButton?r.insertBefore(x,L):L.appendChild(x);break;case"closeLabel":l.closeLabel=e.closeLabel,x.innerHTML=l.closeLabel;break;case"a11y":var c,s,f=e.a11y,u=!1;if(typeof f=="object")for(var m in f)f[m]&&l.a11y[m]&&(l.a11y[m]=f[m],u=!0);u&&(c=A("clr-open-label"),s=A("clr-swatch-label"),c.innerHTML=l.a11y.open,s.innerHTML=l.a11y.swatch,x.setAttribute("aria-label",l.a11y.close),E.setAttribute("aria-label",l.a11y.clear),S.setAttribute("aria-label",l.a11y.hueSlider),W.setAttribute("aria-label",l.a11y.alphaSlider),v.setAttribute("aria-label",l.a11y.input),d.setAttribute("aria-label",l.a11y.instruction));break;default:l[o]=e[o]}}function pt(e,o){typeof e=="string"&&typeof o=="object"&&(X[e]=o,J=!0)}function mt(e){delete X[e],Object.keys(X).length===0&&(J=!1,e===Be&&Pe())}function ht(e){if(J){var o,c=["el","wrap","rtl","inline","defaultColor","a11y"];for(o in X)if(function(s){var f=X[s];if(e.matches(s)){for(var u in Be=s,V={},c.forEach(function(m){return delete f[m]}),f)V[u]=Array.isArray(l[u])?l[u].slice():l[u];return de(f),"break"}}(o)==="break")break}}function Pe(){0<Object.keys(V).length&&(de(V),Be="",V={})}function De(e){b(t,"click",e,function(o){l.inline||(ht(o.target),D=o.target,G=D.value,se=_e(G),r.classList.add("clr-open"),fe(),me(G),(l.focusInput||l.selectInput)&&v.focus({preventScroll:!0}),l.selectInput&&v.select(),D.dispatchEvent(new Event("open",{bubbles:!0})))}),b(t,"input",e,function(o){var c=o.target.parentNode;c.classList.contains("clr-field")&&(c.style.color=o.target.value)})}function fe(){var e,o,c,s,f=i,u=n.scrollY,m=r.offsetWidth,h=r.offsetHeight,p={left:!1,top:!1},w={x:0,y:0};f&&(c=n.getComputedStyle(f),e=parseFloat(c.marginTop),s=parseFloat(c.borderTopWidth),(w=f.getBoundingClientRect()).y+=s+u),l.inline||(c=(o=D.getBoundingClientRect()).x,s=u+o.y+o.height+l.margin,f?(c-=w.x,s-=w.y,c+m>f.clientWidth&&(c+=o.width-m,p.left=!0),s+h>f.clientHeight-e&&h+l.margin<=o.top-(w.y-u)&&(s-=o.height+h+2*l.margin,p.top=!0),s+=f.scrollTop):(c+m>t.documentElement.clientWidth&&(c+=o.width-m,p.left=!0),s+h-u>t.documentElement.clientHeight&&h+l.margin<=o.top&&(s=u+o.y-h-l.margin,p.top=!0)),r.classList.toggle("clr-left",p.left),r.classList.toggle("clr-top",p.top),r.style.left=c+"px",r.style.top=s+"px",w.x+=r.offsetLeft,w.y+=r.offsetTop),y={width:d.offsetWidth,height:d.offsetHeight,x:d.offsetLeft+w.x,y:d.offsetTop+w.y}}function pe(e){t.querySelectorAll(e).forEach(function(o){var c,s,f=o.parentNode;f.classList.contains("clr-field")||(c=t.createElement("div"),s="clr-field",(l.rtl||o.classList.contains("clr-rtl"))&&(s+=" clr-rtl"),c.innerHTML='<button type="button" aria-labelledby="clr-open-label"></button>',f.insertBefore(c,o),c.setAttribute("class",s),c.style.color=o.value,c.appendChild(o))})}function U(e){var o;D&&!l.inline&&(o=D,e&&(D=null,G!==o.value&&(o.value=G,o.dispatchEvent(new Event("input",{bubbles:!0})))),setTimeout(function(){G!==o.value&&o.dispatchEvent(new Event("change",{bubbles:!0}))}),r.classList.remove("clr-open"),J&&Pe(),o.dispatchEvent(new Event("close",{bubbles:!0})),l.focusInput&&o.focus({preventScroll:!0}),D=null)}function me(c){var o=function(s){var f;return ue.fillStyle="#000",ue.fillStyle=s,(s=/^((rgba)|rgb)[\D]+([\d.]+)[\D]+([\d.]+)[\D]+([\d.]+)[\D]*?([\d.]+|$)/i.exec(ue.fillStyle))?(f={r:+s[3],g:+s[4],b:+s[5],a:+s[6]}).a=+f.a.toFixed(2):(s=ue.fillStyle.replace("#","").match(/.{2}/g).map(function(u){return parseInt(u,16)}),f={r:s[0],g:s[1],b:s[2],a:1}),f}(c),c=function(s){var f=s.r/255,u=s.g/255,m=s.b/255,h=a.max(f,u,m),C=a.min(f,u,m),p=h-C,w=h,M=0,C=0;return p&&(h===f&&(M=(u-m)/p),h===u&&(M=2+(m-f)/p),h===m&&(M=4+(f-u)/p),h&&(C=p/h)),{h:(M=a.floor(60*M))<0?M+360:M,s:a.round(100*C),v:a.round(100*w),a:s.a}}(o);Ye(c.s,c.v),he(o,c),S.value=c.h,r.style.color="hsl("+c.h+", 100%, 50%)",Me.style.left=c.h/360*100+"%",g.style.left=y.width*c.s/100+"px",g.style.top=y.height-y.height*c.v/100+"px",W.value=100*c.a,q.style.left=100*c.a+"%"}function _e(e){return e=e.substring(0,3).toLowerCase(),e==="rgb"||e==="hsl"?e:"hex"}function R(e){e=e!==void 0?e:v.value,D&&(D.value=e,D.dispatchEvent(new Event("input",{bubbles:!0}))),l.onChange&&l.onChange.call(n,e),t.dispatchEvent(new CustomEvent("coloris:pick",{detail:{color:e}}))}function $e(e,o){e={h:+S.value,s:e/y.width*100,v:100-o/y.height*100,a:W.value/100},o=function(c){var s=c.s/100,f=c.v/100,u=s*f,m=c.h/60,h=u*(1-a.abs(m%2-1)),p=f-u;return u+=p,h+=p,s=a.floor(m)%6,f=[u,h,p,p,h,u][s],m=[h,u,u,h,p,p][s],s=[p,p,h,u,u,h][s],{r:a.round(255*f),g:a.round(255*m),b:a.round(255*s),a:c.a}}(e),Ye(e.s,e.v),he(o,e),R()}function Ye(e,o){var c=l.a11y.marker;e=+e.toFixed(1),o=+o.toFixed(1),c=(c=c.replace("{s}",e)).replace("{v}",o),g.setAttribute("aria-label",c)}function F(e){var c={pageX:((o=e).changedTouches?o.changedTouches[0]:o).pageX,pageY:(o.changedTouches?o.changedTouches[0]:o).pageY},o=c.pageX-y.x,c=c.pageY-y.y;i&&(c+=i.scrollTop),Ze(o,c),e.preventDefault(),e.stopPropagation()}function Ze(e,o){e=e<0?0:e>y.width?y.width:e,o=o<0?0:o>y.height?y.height:o,g.style.left=e+"px",g.style.top=o+"px",$e(e,o),g.focus()}function he(e,o){o===void 0&&(o={});var c,s,f=l.format;for(c in e=e===void 0?{}:e)z[c]=e[c];for(s in o)z[s]=o[s];var u,m=function(p){var w=p.r.toString(16),M=p.g.toString(16),C=p.b.toString(16),ge="";return p.r<16&&(w="0"+w),p.g<16&&(M="0"+M),p.b<16&&(C="0"+C),l.alpha&&(p.a<1||l.forceAlpha)&&(p=255*p.a|0,ge=p.toString(16),p<16&&(ge="0"+ge)),"#"+w+M+C+ge}(z),h=m.substring(0,7);switch(g.style.color=h,q.parentNode.style.color=h,q.style.color=m,L.style.color=m,d.style.display="none",d.offsetHeight,d.style.display="",q.nextElementSibling.style.display="none",q.nextElementSibling.offsetHeight,q.nextElementSibling.style.display="",f==="mixed"?f=z.a===1?"hex":"rgb":f==="auto"&&(f=se),f){case"hex":v.value=m;break;case"rgb":v.value=(u=z,!l.alpha||u.a===1&&!l.forceAlpha?"rgb("+u.r+", "+u.g+", "+u.b+")":"rgba("+u.r+", "+u.g+", "+u.b+", "+u.a+")");break;case"hsl":v.value=(u=function(p){var w,M=p.v/100,C=M*(1-p.s/100/2);return 0<C&&C<1&&(w=a.round((M-C)/a.min(C,1-C)*100)),{h:p.h,s:w||0,l:a.round(100*C),a:p.a}}(z),!l.alpha||u.a===1&&!l.forceAlpha?"hsl("+u.h+", "+u.s+"%, "+u.l+"%)":"hsla("+u.h+", "+u.s+"%, "+u.l+"%, "+u.a+")")}t.querySelector('.clr-format [value="'+f+'"]').checked=!0}function gt(){var e=+S.value,o=+g.style.left.replace("px",""),c=+g.style.top.replace("px","");r.style.color="hsl("+e+", 100%, 50%)",Me.style.left=e/360*100+"%",$e(o,c)}function yt(){var e=W.value/100;q.style.left=100*e+"%",he({a:e}),R()}function A(e){return t.getElementById(e)}function b(e,o,c,s){var f=Element.prototype.matches||Element.prototype.msMatchesSelector;typeof c=="string"?e.addEventListener(o,function(u){f.call(u.target,c)&&s.call(u.target,u)}):(s=c,e.addEventListener(o,s))}function Oe(e,o){o=o!==void 0?o:[],t.readyState!=="loading"?e.apply(void 0,o):t.addEventListener("DOMContentLoaded",function(){e.apply(void 0,o)})}NodeList!==void 0&&NodeList.prototype&&!NodeList.prototype.forEach&&(NodeList.prototype.forEach=Array.prototype.forEach),n.Coloris=function(){var e={set:de,wrap:pe,close:U,setInstance:pt,removeInstance:mt,updatePosition:fe};function o(s){Oe(function(){s&&(typeof s=="string"?De:de)(s)})}for(var c in e)(function(s){o[s]=function(){for(var f=arguments.length,u=new Array(f),m=0;m<f;m++)u[m]=arguments[m];Oe(e[s],u)}})(c);return o}(),Oe(function(){i=null,(r=t.createElement("div")).setAttribute("id","clr-picker"),r.className="clr-picker",r.innerHTML='<input id="clr-color-value" name="clr-color-value" class="clr-color" type="text" value="" spellcheck="false" aria-label="'+l.a11y.input+'"><div id="clr-color-area" class="clr-gradient" role="application" aria-label="'+l.a11y.instruction+'"><div id="clr-color-marker" class="clr-marker" tabindex="0"></div></div><div class="clr-hue"><input id="clr-hue-slider" name="clr-hue-slider" type="range" min="0" max="360" step="1" aria-label="'+l.a11y.hueSlider+'"><div id="clr-hue-marker"></div></div><div class="clr-alpha"><input id="clr-alpha-slider" name="clr-alpha-slider" type="range" min="0" max="100" step="1" aria-label="'+l.a11y.alphaSlider+'"><div id="clr-alpha-marker"></div><span></span></div><div id="clr-format" class="clr-format"><fieldset class="clr-segmented"><legend>'+l.a11y.format+'</legend><input id="clr-f1" type="radio" name="clr-format" value="hex"><label for="clr-f1">Hex</label><input id="clr-f2" type="radio" name="clr-format" value="rgb"><label for="clr-f2">RGB</label><input id="clr-f3" type="radio" name="clr-format" value="hsl"><label for="clr-f3">HSL</label><span></span></fieldset></div><div id="clr-swatches" class="clr-swatches"></div><button type="button" id="clr-clear" class="clr-clear" aria-label="'+l.a11y.clear+'">'+l.clearLabel+'</button><div id="clr-color-preview" class="clr-preview"><button type="button" id="clr-close" class="clr-close" aria-label="'+l.a11y.close+'">'+l.closeLabel+'</button></div><span id="clr-open-label" hidden>'+l.a11y.open+'</span><span id="clr-swatch-label" hidden>'+l.a11y.swatch+"</span>",t.body.appendChild(r),d=A("clr-color-area"),g=A("clr-color-marker"),E=A("clr-clear"),x=A("clr-close"),L=A("clr-color-preview"),v=A("clr-color-value"),S=A("clr-hue-slider"),Me=A("clr-hue-marker"),W=A("clr-alpha-slider"),q=A("clr-alpha-marker"),De(l.el),pe(l.el),b(r,"mousedown",function(e){r.classList.remove("clr-keyboard-nav"),e.stopPropagation()}),b(d,"mousedown",function(e){b(t,"mousemove",F)}),b(d,"touchstart",function(e){t.addEventListener("touchmove",F,{passive:!1})}),b(g,"mousedown",function(e){b(t,"mousemove",F)}),b(g,"touchstart",function(e){t.addEventListener("touchmove",F,{passive:!1})}),b(v,"change",function(e){(D||l.inline)&&(me(v.value),R())}),b(E,"click",function(e){R(""),U()}),b(x,"click",function(e){R(),U()}),b(t,"click",".clr-format input",function(e){se=e.target.value,he(),R()}),b(r,"click",".clr-swatches button",function(e){me(e.target.textContent),R(),l.swatchesOnly&&U()}),b(t,"mouseup",function(e){t.removeEventListener("mousemove",F)}),b(t,"touchend",function(e){t.removeEventListener("touchmove",F)}),b(t,"mousedown",function(e){r.classList.remove("clr-keyboard-nav"),U()}),b(t,"keydown",function(e){e.key==="Escape"?U(!0):["Tab","ArrowUp","ArrowDown","ArrowLeft","ArrowRight"].includes(e.key)&&r.classList.add("clr-keyboard-nav")}),b(t,"click",".clr-field button",function(e){J&&Pe(),e.target.nextElementSibling.dispatchEvent(new Event("click",{bubbles:!0}))}),b(g,"keydown",function(e){var o={ArrowUp:[0,-1],ArrowDown:[0,1],ArrowLeft:[-1,0],ArrowRight:[1,0]};Object.keys(o).includes(e.key)&&(function(c,s){Ze(+g.style.left.replace("px","")+c,+g.style.top.replace("px","")+s)}.apply(void 0,o[e.key]),e.preventDefault())}),b(d,"click",F),b(S,"input",gt),b(W,"input",yt)})})(window,document,Math);let kt="/fidget//fidgetgallery.glb";Coloris&&Coloris.setInstance(".colorPicker",{theme:"polaroid",themeMode:"dark",alpha:!1,formatToggle:!0,swatches:["#264653","#2a9d8f","#e9c46a"]});const Te={joystick:{rotation:{min:10,max:10}}},Lt=Object.keys(Te);let Z={max:10,min:5};var Le={};const Et={"#colorMenuDraggable":{handle:"#dragHandleColor",origin:{top:"80px",left:"110px"}},"#materialsMenuDraggable":{handle:"#dragHandleMaterial",origin:{top:"150px",left:"100px"}},"#zoomMenuDraggable":{handle:"#dragHandleZoom",origin:{top:"90%",left:"60%"}}},We=Object.entries(Et).reduce((n,[t,{handle:a,origin:i}])=>{let r=document.querySelector(t),d=document.querySelector(a);return i.top&&(r.style.top=i.top),i.left&&(r.style.left=i.left),{...n,[t]:{object:r,handle:d,origin:i}}},{});let Q;var Ce={};const Ee={sphere:{spin:{}},discs:{spinDiscA:{},spinDiscB:{},spinDiscC:{},spinDiscD:{}}};let N,P,Ke,Qe,je,O,xe,T,He,et,re={},k={},tt=[],ee=[],nt=[],H,oe,Ge,Se,ae,ie,le,ye,ve,be,j,we,ke,Ie,qe,te,Y,Re,I,_,ze=!1,ne=!1,$=!1,rt=!1,K=0;var Xe=0,Ve=0,Fe=0,Ne=0;H=document.querySelector("#app");N=new B.Scene;N.background=null;P=new B.WebGLRenderer({antialias:!0,alpha:!0});Ke=new wt;Qe=new B.PMREMGenerator(P);N.environment=Qe.fromScene(Ke).texture;je=new bt;O=new B.PerspectiveCamera(75,H.offsetWidth/H.offsetHeight,.1,1e3);T=new vt(O,P.domElement);T.maxDistance=Z.max;T.minDistance=Z.min;T.enablePan=!1;He=new B.Raycaster;new B.Vector2;new B.Vector2;et=new B.Clock;P.setSize(H.offsetWidth,H.offsetHeight);P.setPixelRatio(window.devicePixelRatio);P.toneMapping=B.ACESFilmicToneMapping;P.toneMappingExposure=1;P.outputEncoding=B.sRGBEncoding;P.setClearColor(0,0);H.appendChild(P.domElement);oe=document.getElementById("colorPicker");Ge=document.getElementById("colorOpenButton");Se=document.getElementById("colorPickerLockButton");j=document.querySelector("#colorLockSpan");ie=document.getElementById("metalSlider");ae=document.getElementById("roughSlider");ve=document.getElementById("prevNavButton");be=document.getElementById("nextNavButton");document.getElementById("materialMenu");le=document.querySelector("#dragToggle");ye=document.querySelector("#resetDrag");Y=document.querySelector("#copyPropsButton");Re=document.querySelector(".pasteProps");I=document.querySelector("#pastePropsButton");document.querySelector("#pastePropsIcon");ke=document.querySelector("#colorPasteSwatch");Ie=document.querySelector("#metalPasteSwatch");qe=document.querySelector("#roughPasteSwatch");we=document.querySelector("#helpButton");_=document.querySelector("#playAnimationButton");te=document.querySelector("#zoomSlider");P.setAnimationLoop(ot);je.load(kt,qt,void 0,function(n){console.log(n)});window.addEventListener("pointerdown",Tt);window.addEventListener("pointermove",It);window.addEventListener("pointerup",Ht);window.addEventListener("resize",Rt);T.addEventListener("change",Bt);Ge.addEventListener("click",Ue);Se.addEventListener("click",Ct);ie.addEventListener("input",$t);ae.addEventListener("input",Yt);te==null||te.addEventListener("input",Pt);ve==null||ve.addEventListener("click",st);be==null||be.addEventListener("click",()=>{st("next")});le.addEventListener("click",xt);ye==null||ye.addEventListener("click",St);Y==null||Y.addEventListener("click",At);I==null||I.addEventListener("click",Mt);we==null||we.addEventListener("click",()=>{ut(!0)});document.addEventListener("coloris:pick",n=>{_t(k,n.detail.color)});Object.entries(We).forEach(([n,{object:t,handle:a}])=>{t.onpointerdown=i=>Nt(i,n,t,a)});function ot(n){xe&&xe.update(et.getDelta()),P.render(N,O)}function xt(){$=!$,Object.values(We).forEach(({_:n,handle:t})=>{t.style.display=$?"flex":"none"}),$?le.classList.add("toggleDragButtonActive"):le.classList.remove("toggleDragButtonActive")}function St(){$=!1,Object.values(We).forEach(({object:n,handle:t,origin:a})=>{t.style.display="none",a.top&&(n.style.top=a.top),a.left&&(n.style.left=a.left),a.bottom&&(n.style.bottom=a.bottom),a.right&&(n.style.right=a.right)}),le.classList.remove("toggleDragButtonActive"),lt(!1),at(!1),Ce={},Ae(void 0)}function Ct(){ne=!ne,it(ne)}function At(){if(!k||!("color"in k))return;let n="#"+k.color.getHexString(),t=ie.value/100,a=ae.value/100;n&&t&&a&&(Ce={color:n,metalic:t,roughness:a},at(!0))}function Mt(){if(!I.classList.contains("pastePropsButtonActive")||!k||!("color"in k))return;let{color:n,metalic:t,roughness:a}=Ce;n&&"color"in k&&k.color.set(n),t&&"metalness"in k&&(k.metalness=t),a&&"roughness"in k&&(k.roughness=a),Ae(n),ie.value=t*100,ae.value=a*100}function lt(n){n?Y.classList.add("copyPropsButtonActive"):Y.classList.remove("copyPropsButtonActive")}function at(n){if(n){I.classList.add("pastePropsButtonActive"),pastePropsIcon.textContent="content_paste";let{color:t,metalic:a,roughness:i}=Ce;I.style.setProperty("--background-color",t),ke.style.backgroundColor=t,ke.style.display="block",Ie.style.display="block",qe.style.display="block",Re.style.setProperty("--metalness",`${a*100}%`),Re.style.setProperty("--roughness",`${i*100}%`)}else I.classList.remove("pastePropsButtonActive"),pastePropsIcon.textContent="content_paste_off",I.style.setProperty("--background-color","none"),ke.style.display="none",Ie.style.display="none",qe.style.display="none"}function Bt(n){if(!T.enableZoom)return;let i=100-((O.position.distanceTo(Le.position)||void 0)-Z.min)/Z.min*100;i<0&&(i=0),te.value=i}function Pt(n){let{target:{value:t}}=n||void 0;if(!t)return;t/=100;let a=O.position.distanceTo(Le.position);const i=Z.max-Z.min*t;O.position.lerpVectors(Le.position,O.position,i/a)}function it(n){n?(j.innerText="water_lock",Se.classList.add("colorLockButtonActive"),j.classList.add("colorLockSpanActive"),Ue()):(j.innerText="lock_open_right",Se.classList.remove("colorLockButtonActive"),j.classList.remove("colorLockSpanActive"),Dt())}function Ue(){oe.dispatchEvent(new Event("click",{bubbles:!0}))}function ct(n){var i;!ne||!n||!n.target||(((i=n==null?void 0:n.target)==null?void 0:i.id)||"").includes("color-area")||Ue()}function Dt(){oe.dispatchEvent(new Event("close",{bubbles:!0}))}function Ot(n){oe.value=n,oe.dispatchEvent(new Event("input",{bubbles:!0})),ct()}function Ae(n){let t=n||"conic-gradient(red, orange, yellow, green, blue, purple, red)";Ge.style.background=t}function Tt(n){rt&&ut(!1),ze=!0;let t=ce(n,!0);({...t},He.setFromCamera(t,O));const a=He.intersectObjects(N.children);let i=!1,r=!1;for(let d of a){if(i&&r)break;d.object.visible&&(d.object.material&&!r&&(ft(d.object.material),r=!0),Lt.indexOf(d.object.name)>=0&&(re=d.object,T.enableRotate=!1,i=!0))}ct(n)}function Ht(){re={},T.enableRotate=!0,ze=!1}function It(n){!ze||!re.name||(ce(n,!0),re.userData.limit.rotation&&Ft(n),ot())}function qt(n){const t=n.scene;N.add(t),xe=new B.AnimationMixer(t),n.animations.forEach(i=>{Object.entries(Ee).forEach(([r,d])=>{if(d&&Object.keys(d).indexOf(i.name)>-1)return Ee[r][i.name]=xe.clipAction(i)})}),t.children.forEach(i=>{if(i.name.indexOf("camera")>-1)return ee.push(i);if(i.name.indexOf("focus")>-1)return nt.push(i);if(i.name.indexOf("hidden")>-1||!i.userData.group)return console.log("Needs Group ID to be visible"),i.visible=!1;i.userData.type==="rotate"&&Te[i.name]&&(i.userData.limit={...Te[i.name]},i.userData.update=()=>i.position.clamp(i.userData.limit.min,i.userData.limit.max)),tt.push(i)}),dt("focus1"),O.position.copy(ee[0].position),T.update()}function st(n){let t=n==="next";const a=function(){return K>=ee.length-1&&t?0:K<1&&!t?ee.length-1:t?K+1:K-1}(),i=ee[a],r=nt[a];O.position.copy(i.position),r&&(T.target.copy(r.position),dt(r.name)),K=a,T.update()}function Rt(){O.aspect=H.offsetWidth/H.offsetHeight,O.updateProjectionMatrix(),P.setSize(H.offsetWidth,H.offsetHeight)}function ut(n){let t="helpItemHidden";document.querySelectorAll(".helpItem").forEach(a=>{if(n===!0)return a.classList.remove(t);a.classList.add(t)}),rt=n}function dt(n){let t=N.getObjectByProperty("name",n);t&&(Le=t);let a="",i=!1;tt.forEach(r=>{var d,y;if(r.userData.focus===n)return a===""&&((d=r.userData)!=null&&d.group)&&(a=r.userData.group),(y=r==null?void 0:r.userData)!=null&&y.group&&Ee[r.userData.group]&&(Je(!0,Ee[r.userData.group]),i=!0),r.material&&ft(r.material),r.visible=!0;r.visible=!1}),i||Je(!1,void 0)}function Ft(n){var t=ce(n);Ut(t,re,30)}function Nt(n,t,a,i){if(!$||(n=n||window.event,i.id!==n.target.id))return;i.id==="dragHandleColor"&&(ne=!1,it(!1)),Q=a;let{x:r,y:d}=ce(n);Fe=r,Ne=d,document.onpointerup=Gt,document.onpointermove=Wt}function Wt(n){n=n||window.event;let{x:t,y:a}=ce(n);Xe=Fe-t,Ve=Ne-a,Fe=t,Ne=a,Q.style.top=Q.offsetTop-Ve+"px",Q.style.left=Q.offsetLeft-Xe+"px"}function Gt(){document.onpointerup=null,document.onpointermove=null}function zt(n,t,a){let i=0,r=0,d,y,g,L,v={x:window.innerWidth,y:window.innerHeight};return n<=v.x/2&&(d=v.x/2-n,y=d/(v.x/2)*100,i=a*y/100*-1),n>=v.x/2&&(d=n-v.x/2,y=d/(v.x/2)*100,i=a*y/100),t<=v.y/2&&(g=v.y/2-t,L=g/(v.y/2)*100,r=a*L/100*-1),t>=v.y/2&&(g=t-v.y/2,L=g/(v.y/2)*100,r=a*L/100),{x:i,y:r}}function Ut(n,t,a){let i=zt(n.x,n.y,a);t.rotation.y=B.MathUtils.degToRad(i.x),t.rotation.z=B.MathUtils.degToRad(i.y)}function ft(n){k=n,ie.value=n.metalness*100,ae.value=n.roughness*100;let t=n.color.getHexString();Ot(`#${t}`),lt(!0),Ae(`#${t}`)}function Je(n,t){if(!n){_.classList.remove("playAnimationButtonActive"),_.enabled=!1;return}_.onclick=()=>{Object.values(t).forEach(a=>{a!=null&&a.play&&a.setLoop(B.LoopOnce).play().reset()})},_.classList.add("playAnimationButtonActive"),_.enabled=!0}function _t(n,t){const a=Zt(t);a&&(Ae(a),"color"in n&&n.color.set(a))}function $t(n){let t=n.target.value;!t||!("metalness"in k)||(k.metalness=t/100)}function Yt(n){let t=n.target.value;!t||!("roughness"in k)||(k.roughness=t/100)}function ce(n,t){let a=n.type.indexOf("touch")>-1,{clientX:i,clientY:r}=(()=>a?n.touches[0]:n)();return t?{x:i/window.innerWidth*2-1,y:-(r/window.innerHeight)*2+1}:{x:i,y:r}}function Zt(n){if(n.indexOf("#")>-1)return n;let t=n.replaceAll(" ","").replaceAll("(","").replaceAll(")","").replaceAll("%","").replaceAll("rgb","").replaceAll("hsl",""),a;if(n.indexOf("rgb")>-1&&(a=t.split(",")),n.indexOf("hsl")>-1){let[r,d,y]=t.split(",");d/=100,y/=100;let g=(1-Math.abs(2*y-1))*d,L=g*(1-Math.abs(r/60%2-1)),v=y-g/2,E=0,x=0,S=0;0<=r&&r<60?(E=g,x=L,S=0):60<=r&&r<120?(E=L,x=g,S=0):120<=r&&r<180?(E=0,x=g,S=L):180<=r&&r<240?(E=0,x=L,S=g):240<=r&&r<300?(E=L,x=0,S=g):300<=r&&r<360&&(E=g,x=0,S=L),E=Math.round((E+v)*255),x=Math.round((x+v)*255),S=Math.round((S+v)*255),a=[E,x,S]}if(!(!a||!a[2])){var i=a.map(function(r){return r=parseInt(r).toString(16),r.length==1?"0"+r:r});return"#"+i.join("")}}
